var about=$(".about span"),output=$("#howlong"),sun=$(".sun-selector"),cloudparts=$(".opencloud.cloud, .opencloud.cloud::after, .opencloud.cloud::before");$(function(){$(".cloudlayer .cloud").addClass("animate-cloudToLeft"),sun.click(geolocate),$(".opencloud.cloud").click(function(){$(".pane").addClass("full")}),$(".closecloud.cloud").click(function(){$(".pane").removeClass("full")})});var geolocate=function(){about.animate({color:"#ffffcc",opacity:"0"},400),$("body").css("cursor","wait"),navigator.geolocation?navigator.geolocation.getCurrentPosition(sunsetCalc):alert("Sorry! Geolocation is not supported by your browser. We will be adding zip code functionality soon.")},sunsetCalc=function(o){$("body").css("cursor","auto"),$("#sunner").animate({opacity:1}),output.hide();var t=o.coords.latitude,n=o.coords.longitude,a=new Date,e=SunCalc.getTimes(new Date,t,n),s=e.dusk,u=e.dawn,d=s-a,r=Math.floor(d/1e3),l=Math.floor(r/3600),c=Math.floor(r%3600/60),i=Math.floor(r%3600%60);if(u>a){var d=u-a;r=Math.floor(d/1e3),l=Math.floor(r/3600),c=Math.floor(r%3600/60),i=Math.floor(r%3600%60),output.text("Dawn is coming in "+l+" hours & "+c+" minutes."),$(".svg-container").addClass("moon"),$("html").addClass("moon"),$(".about span, #howlong").css("color","#DDD")}else 0>d?(console.log("diff < 0"),d=-1*d,r=Math.floor(d/1e3),l=Math.floor(r/3600),c=Math.floor(r%3600/60),i=Math.floor(r%3600%60),l>=1?output.text("Oh no! Dusk began "+l+" hours, "+c+" minutes, and "+i+" seconds ago!"):output.text("Oh no! Dusk began "+c+" minutes and "+i+" seconds ago!"),$(".svg-container").addClass("moon"),$("html").addClass("moon"),$(".about span, #howlong").css("color","#DDD")):2>=l&&l>=1?(output.text("Better hurry! You have "+l+" hours, "+c+" minutes, & "+i+" seconds until dusk!"),$(".svg-container").addClass("day"),barGraph(e,l,c)):1>l?(output.text("Better hurry! You have "+c+" minutes, & "+i+" seconds until dusk!"),$(".svg-container").addClass("day"),barGraph(e,l,c)):l>=2&&(output.text("You have "+l+" hours, "+c+" minutes, & "+i+" seconds until dusk!"),$(".svg-container").addClass("day"),barGraph(e,l,c));$(".time").css("display","inline-block"),output.fadeIn(1200),about.empty()},barGraph=function(o){console.log("barGraph ran");for(var t=new Function("hours","minutes","return hours*60 + minutes"),n=[o.dawn,o.dusk,o.night,o.nightEnd,o.solarNoon],a=0;4>=a;a++)n[a]=t(n[a].getHours(),n[a].getMinutes());var e=n[0],s=n[1],u=n[2],d=n[3],r=n[4],l=new Date,c=60*l.getHours()+l.getMinutes(),i=u-d,h=(e-d)/i,f=(s-d)/i,g=(r-d)/i,p=(c-e)/i;before_dawn=100*h,dawn_to_noon=100*(g-h),noon_to_dusk=100*(f-g),at_dusk=Math.round(1-(before_dawn+dawn_to_noon+noon_to_dusk)),console.log(at_dusk),duskbar=100- -1*at_dusk,adjusted_dusk=100-(before_dawn+dawn_to_noon+noon_to_dusk),$(".bargraph").fadeIn(),$("#before-dawn").width(before_dawn+"%"),$("#dawn-to-noon").width(dawn_to_noon+"%"),$("#noon-to-dusk").width(noon_to_dusk+"%"),$("#dusk").width(adjusted_dusk+"%"),$("#elapsed").width(100*p+"%")};